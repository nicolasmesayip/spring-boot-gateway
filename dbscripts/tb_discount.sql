CREATE TABLE IF NOT EXISTS tb_discount (
  ID                       BIGINT         NOT NULL AUTO_INCREMENT,
  DISCOUNT_CODE            VARCHAR(12)    NOT NULL UNIQUE,
  DESCRIPTION              VARCHAR(255)   NOT NULL,
  DISCOUNT_TYPE            VARCHAR(50)    NOT NULL,
  DISCOUNT                 DECIMAL(13,4)  NULL,
  CURRENCY                 VARCHAR(3)     NULL,
  MINIMUM_PURCHASE_AMOUNT  DECIMAL(13,2)  DEFAULT NULL,
  IS_ACTIVE                TINYINT(1)     NOT NULL DEFAULT 1,
  TIMES_USED               INT            NOT NULL DEFAULT 0,
  MAX_USES                 INT            DEFAULT NULL,
  IS_STACKABLE             TINYINT(1)     NOT NULL DEFAULT 0,
  START_DATE_TIME          DATETIME(6)    NOT NULL,
  END_DATE_TIME            DATETIME(6)    DEFAULT NULL,
  UPDATED_BY               VARCHAR(50)    NOT NULL,
  CREATED_BY               VARCHAR(50)    DEFAULT NULL,
  UPDATED_AT               DATETIME(6)    NOT NULL DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
  CREATED_AT               DATETIME(6)    NOT NULL DEFAULT CURRENT_TIMESTAMP(6),
  LAST_USED_AT             DATETIME(6),
  PRIMARY KEY (ID),
  CHECK (DISCOUNT > 0),
  CHECK (MAX_USES IS NULL OR MAX_USES > 0),
  CHECK (MINIMUM_PURCHASE_AMOUNT IS NULL OR MINIMUM_PURCHASE_AMOUNT >= 0)
);